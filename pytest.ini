[tool:pytest]
# Debugging doom loop prevention pytest configuration

# Test discovery
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Test timeouts matching HALT protocol
timeout = 1800  # 30 minutes max for any single test
timeout_method = thread

# Markers for test layers
markers =
    diagnostics: Health check tests (< 1 second)
    unit: Pure function tests (< 5 seconds)  
    integration: Service interaction tests (< 30 seconds)
    e2e: Complete workflow tests (< 2 minutes)
    slow: Tests that may take longer than usual
    debug: One-off debugging tests

# Output configuration
addopts = 
    -ra
    --strict-markers
    --strict-config
    --cov=.
    --cov-report=term-missing
    --cov-report=html:tests/coverage
    --html=tests/reports/report.html
    --self-contained-html
    --json-report
    --json-report-file=tests/reports/report.json

# Logging
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Filterwarnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning